{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Encoder-Decoder model for ENSO-forecasting\n",
    "\n",
    "The Encoder-Decoder model is enspired by the architecture of autoencoders. Here, the size of the input layer of the neural network is the same size as the output layer. Furthermore, there is a so-called bottleneck layer present in the network which has less neurons than the input/output layers. For an Autoencoder the label and feature are the same. Because of the bottleneck layer, the network is forced to learn a lower dimesional expression of the input\n",
    "\n",
    "For the Encoder-Decoder model (DEM), a time lag between the feature and the label is introduced. Such that the DEM is a forecast model. Hence, the DEM is forced to learn a lower dimensional expression that explains best the future state of the considered variable field.\n",
    "\n",
    "<img src=\"AE_example.png\" alt=\"Drawing\" style=\"width: 400px;\"/>\n",
    "\n",
    "In this tutorial, the considered variable field is again the SST anomaly data from the ERSSTv5  data set."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Read data \n",
    "\n",
    "In the following cell, we read the SST anoamly data that was computed in an earlier tutorial."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/paul/miniconda2/envs/ninolearn/lib/python3.6/site-packages/xarray/core/nanops.py:160: RuntimeWarning: Mean of empty slice\n",
      "  return np.nanmean(a, axis=axis, dtype=dtype)\n"
     ]
    }
   ],
   "source": [
    "from ninolearn.IO.read_post import data_reader\n",
    "\n",
    "#read data\n",
    "reader = data_reader(startdate='1959-11', enddate='2018-12')\n",
    "\n",
    "# read SST data and directly make seasonal averages\n",
    "SSTA = reader.read_netcdf('sst', dataset='ERSSTv5', processed='anom').rolling(time=3).mean()[2:]\n",
    "\n",
    "# read the ONI for later comparison\n",
    "oni = reader.read_csv('oni')[2:]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Generate the feature and label arrays\n",
    "\n",
    "The following cell generates the feature and label arrays. Because `feature` and `label` need to refer to an other object in the backend so that they can be changed without influencing each other.\n",
    "\n",
    "Moreover, the data is scalled because this helps the DEM to be more precise."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/paul/miniconda2/envs/ninolearn/lib/python3.6/site-packages/sklearn/utils/extmath.py:747: RuntimeWarning: invalid value encountered in true_divide\n",
      "  updated_mean = (last_sum + new_sum) / updated_sample_count\n",
      "/home/paul/miniconda2/envs/ninolearn/lib/python3.6/site-packages/sklearn/utils/extmath.py:688: RuntimeWarning: Degrees of freedom <= 0 for slice.\n",
      "  result = op(x, *args, **kwargs)\n",
      "/home/paul/miniconda2/envs/ninolearn/lib/python3.6/site-packages/sklearn/utils/extmath.py:747: RuntimeWarning: invalid value encountered in true_divide\n",
      "  updated_mean = (last_sum + new_sum) / updated_sample_count\n",
      "/home/paul/miniconda2/envs/ninolearn/lib/python3.6/site-packages/sklearn/utils/extmath.py:688: RuntimeWarning: Degrees of freedom <= 0 for slice.\n",
      "  result = op(x, *args, **kwargs)\n"
     ]
    }
   ],
   "source": [
    "from sklearn.preprocessing import StandardScaler\n",
    "import numpy as np\n",
    "\n",
    "# make deep copies of the sst data\n",
    "feature = SSTA.copy(deep=True)\n",
    "label = SSTA.copy(deep=True)\n",
    "\n",
    "# reshape the data such that one time step is a 1-D vector\n",
    "# i.e. the feature_unscaled array is hence 2-D (timestep, number of grid points)\n",
    "feature_unscaled = feature.values.reshape(feature.shape[0],-1)\n",
    "label_unscaled = label.values.reshape(label.shape[0],-1)\n",
    "\n",
    "# scale the data\n",
    "scaler_f = StandardScaler()\n",
    "Xorg = scaler_f.fit_transform(feature_unscaled)\n",
    "\n",
    "scaler_l = StandardScaler()\n",
    "yorg = scaler_l.fit_transform(label_unscaled)\n",
    "\n",
    "# replace nans with 0\n",
    "Xall = np.nan_to_num(Xorg)\n",
    "yall = np.nan_to_num(yorg)\n",
    "\n",
    "# shift = 3 is needed to align with the usual way how lead time is defined\n",
    "shift = 3\n",
    "\n",
    "# the lead time\n",
    "lead = 3\n",
    "\n",
    "y = yall[lead+shift:]\n",
    "X = Xall[:-lead-shift]\n",
    "timey = oni.index[lead+shift:]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Split the data set \n",
    "\n",
    "For the training and testing of machine learning models it is crucial to split the data set into:\n",
    "\n",
    "1. __Train data set__ which is used to train the weights of the neural network\n",
    "\n",
    "2. __Validation data set__ which is used to check for overfitting (e.g. when using early stopping) and to optimize the hyperparameters \n",
    "\n",
    "3. __Test data set__ which is used to to evaluate the trained model. \n",
    "\n",
    "__NOTE:__ It is important to understand that hyperparamters must be tuned so that the result is best for the Validation data set and __not__ for the test data set. Otherwise you can not rule out the case that the specific hyperparameter setting just works good for the specific test data set but is not generally a good hyperparameter setting.\n",
    "\n",
    "In the following cell the train and the validation data set are still one data set, because this array will be later splitted into two arrays when th model is fitted."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_indeces = test_indeces = (timey>='2001-01-01') & (timey<='2018-12-01')\n",
    "train_val_indeces = np.invert(test_indeces)\n",
    "\n",
    "train_val_X, train_val_y, train_val_timey = X[train_val_indeces,:], y[train_val_indeces,:], timey[train_val_indeces]\n",
    "testX, testy, testtimey = X[test_indeces,:], y[test_indeces,:], timey[test_indeces]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Fit the model\n",
    "\n",
    "Let's train the model using a random search. This takes quite some time (for `n_iter=100` it took an our on my local machine without GPU support). In this training process the train/validation data set will be splitted  In this example below this train/validation data is first divided into 5 segments (`n_segments=5`). One segment alwawys serves as the validation data set and the rest as training. Each segment is one time (`n_members_segment=1`) the validation data set. Hence, the ensemble consists in the end out of 5 models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using TensorFlow backend.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "##################################################################\n",
      "Search iteration Nr 1/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "WARNING:tensorflow:From /home/paul/miniconda2/envs/ninolearn/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\n",
      "Instructions for updating:\n",
      "Colocations handled automatically by placer.\n",
      "WARNING:tensorflow:From /home/paul/miniconda2/envs/ninolearn/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\n",
      "Instructions for updating:\n",
      "Use tf.cast instead.\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00231: early stopping\n",
      "97/97 [==============================] - 0s 174us/step\n",
      "Loss: 0.606672500212168\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00062: early stopping\n",
      "97/97 [==============================] - 0s 144us/step\n",
      "Loss: 0.8190183221679372\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00075: early stopping\n",
      "97/97 [==============================] - 0s 147us/step\n",
      "Loss: 0.5666148499729707\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00055: early stopping\n",
      "97/97 [==============================] - 0s 178us/step\n",
      "Loss: 0.5022133576501276\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00224: early stopping\n",
      "97/97 [==============================] - 0s 144us/step\n",
      "Loss: 0.7257455707210856\n",
      "Mean loss: 0.6440529201448578\n",
      "New best hyperparameters\n",
      "--------------------------------------\n",
      "Mean loss: 0.6440529201448578\n",
      "{'neurons': (115, 40), 'dropout': 0.096778452998804, 'noise': 0.32317924109898233, 'noise_out': 0.4732234272066452, 'l1_hidden': 0.0004608075916238662, 'l2_hidden': 0.0004222331619876754, 'l1_out': 0.00022723778925678496, 'l2_out': 0.0004727670739600789, 'lr': 0.0004888231261999222, 'batch_size': 100}\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 2/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00086: early stopping\n",
      "97/97 [==============================] - 0s 199us/step\n",
      "Loss: 0.5954928600911013\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 152us/step\n",
      "Loss: 0.8003881358608758\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00065: early stopping\n",
      "97/97 [==============================] - 0s 119us/step\n",
      "Loss: 0.5514511284754449\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00091: early stopping\n",
      "97/97 [==============================] - 0s 143us/step\n",
      "Loss: 0.49608864612186077\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00101: early stopping\n",
      "97/97 [==============================] - 0s 131us/step\n",
      "Loss: 0.8240596897823295\n",
      "Mean loss: 0.6534960920663224\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 3/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00124: early stopping\n",
      "97/97 [==============================] - 0s 228us/step\n",
      "Loss: 0.5686127998165249\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00072: early stopping\n",
      "97/97 [==============================] - 0s 293us/step\n",
      "Loss: 0.783138189119162\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00055: early stopping\n",
      "97/97 [==============================] - 0s 224us/step\n",
      "Loss: 0.5525715172905283\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00090: early stopping\n",
      "97/97 [==============================] - 0s 231us/step\n",
      "Loss: 0.4910680178514461\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00091: early stopping\n",
      "97/97 [==============================] - 0s 229us/step\n",
      "Loss: 0.8227460753057421\n",
      "Mean loss: 0.6436273198766806\n",
      "New best hyperparameters\n",
      "--------------------------------------\n",
      "Mean loss: 0.6436273198766806\n",
      "{'neurons': (358, 24), 'dropout': 0.15999059175503463, 'noise': 0.14186665664706982, 'noise_out': 0.32329776833196106, 'l1_hidden': 0.00041604066708110765, 'l2_hidden': 0.0007073477322080547, 'l1_out': 0.0009040118623627197, 'l2_out': 0.00016894683439016788, 'lr': 0.00794006486644386, 'batch_size': 100}\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 4/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00098: early stopping\n",
      "97/97 [==============================] - 0s 266us/step\n",
      "Loss: 0.5767661824668806\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00155: early stopping\n",
      "97/97 [==============================] - 0s 191us/step\n",
      "Loss: 0.7224303619148805\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 222us/step\n",
      "Loss: 0.5495931994669216\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00063: early stopping\n",
      "97/97 [==============================] - 0s 184us/step\n",
      "Loss: 0.5016216746310598\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00170: early stopping\n",
      "97/97 [==============================] - 0s 188us/step\n",
      "Loss: 0.7145157929548284\n",
      "Mean loss: 0.6129854422869142\n",
      "New best hyperparameters\n",
      "--------------------------------------\n",
      "Mean loss: 0.6129854422869142\n",
      "{'neurons': (291, 28), 'dropout': 0.1431755671115358, 'noise': 0.0013436770698335154, 'noise_out': 0.044187953695428994, 'l1_hidden': 0.00048770934604050453, 'l2_hidden': 0.0004715680269068451, 'l1_out': 0.0005451882364499125, 'l2_out': 0.00044506034982592067, 'lr': 0.00461328522575661, 'batch_size': 100}\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 5/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00136: early stopping\n",
      "97/97 [==============================] - 0s 196us/step\n",
      "Loss: 0.5942402746259552\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00205: early stopping\n",
      "97/97 [==============================] - 0s 179us/step\n",
      "Loss: 0.8169717075898475\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00115: early stopping\n",
      "97/97 [==============================] - 0s 210us/step\n",
      "Loss: 0.5612832310887956\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 181us/step\n",
      "Loss: 0.5093760293783601\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 201us/step\n",
      "Loss: 0.8314401866848936\n",
      "Mean loss: 0.6626622858735705\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 6/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00074: early stopping\n",
      "97/97 [==============================] - 0s 265us/step\n",
      "Loss: 0.5802521502848753\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00136: early stopping\n",
      "97/97 [==============================] - 0s 139us/step\n",
      "Loss: 0.719352242872887\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00071: early stopping\n",
      "97/97 [==============================] - 0s 151us/step\n",
      "Loss: 0.5354131420248562\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00056: early stopping\n",
      "97/97 [==============================] - 0s 153us/step\n",
      "Loss: 0.5020431138805508\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00177: early stopping\n",
      "97/97 [==============================] - 0s 176us/step\n",
      "Loss: 0.7450924681634018\n",
      "Mean loss: 0.6164306234453143\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 7/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00105: early stopping\n",
      "97/97 [==============================] - 0s 173us/step\n",
      "Loss: 0.5728608474289019\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 236us/step\n",
      "Loss: 0.7196937307869036\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 159us/step\n",
      "Loss: 0.5343079656055293\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00085: early stopping\n",
      "97/97 [==============================] - 0s 166us/step\n",
      "Loss: 0.4806606615941549\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00105: early stopping\n",
      "97/97 [==============================] - 0s 154us/step\n",
      "Loss: 0.6744321732176948\n",
      "Mean loss: 0.5963910757266369\n",
      "New best hyperparameters\n",
      "--------------------------------------\n",
      "Mean loss: 0.5963910757266369\n",
      "{'neurons': (182, 27), 'dropout': 0.14701184667627873, 'noise': 0.47310195887639966, 'noise_out': 0.39970232399476907, 'l1_hidden': 0.0005788402233340221, 'l2_hidden': 0.00016721581465872637, 'l1_out': 0.00012507893039011254, 'l2_out': 0.00037851623554726335, 'lr': 0.008440858829299836, 'batch_size': 100}\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 8/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00056: early stopping\n",
      "97/97 [==============================] - 0s 181us/step\n",
      "Loss: 0.600658961792582\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00063: early stopping\n",
      "97/97 [==============================] - 0s 153us/step\n",
      "Loss: 0.7354535460472107\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 145us/step\n",
      "Loss: 0.5489317120350513\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00043: early stopping\n",
      "97/97 [==============================] - 0s 219us/step\n",
      "Loss: 0.49184974690073546\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00063: early stopping\n",
      "97/97 [==============================] - 0s 176us/step\n",
      "Loss: 0.6997109009433038\n",
      "Mean loss: 0.6153209735437766\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 9/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00241: early stopping\n",
      "97/97 [==============================] - 0s 102us/step\n",
      "Loss: 0.6081758067779934\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00203: early stopping\n",
      "97/97 [==============================] - 0s 106us/step\n",
      "Loss: 0.8589829931554106\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00098: early stopping\n",
      "97/97 [==============================] - 0s 106us/step\n",
      "Loss: 0.5681723479143123\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 97us/step\n",
      "Loss: 0.5065507108403235\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00138: early stopping\n",
      "97/97 [==============================] - 0s 110us/step\n",
      "Loss: 0.8356900808122969\n",
      "Mean loss: 0.6755143879000673\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 10/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00198: early stopping\n",
      "97/97 [==============================] - 0s 80us/step\n",
      "Loss: 0.5961801932030117\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00121: early stopping\n",
      "97/97 [==============================] - 0s 84us/step\n",
      "Loss: 0.8544701442276079\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00110: early stopping\n",
      "97/97 [==============================] - 0s 102us/step\n",
      "Loss: 0.5614131470930945\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00082: early stopping\n",
      "97/97 [==============================] - 0s 91us/step\n",
      "Loss: 0.5177339843867981\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00170: early stopping\n",
      "97/97 [==============================] - 0s 90us/step\n",
      "Loss: 0.8416371751077396\n",
      "Mean loss: 0.6742869288036504\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 11/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00061: early stopping\n",
      "97/97 [==============================] - 0s 309us/step\n",
      "Loss: 0.5969452268069553\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00060: early stopping\n",
      "97/97 [==============================] - 0s 283us/step\n",
      "Loss: 0.7354880485338035\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 287us/step\n",
      "Loss: 0.5435341627327437\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 287us/step\n",
      "Loss: 0.49608362704208214\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00159: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 517us/step\n",
      "Loss: 0.6663930084287506\n",
      "Mean loss: 0.607688814708867\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 12/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00097: early stopping\n",
      "97/97 [==============================] - 0s 170us/step\n",
      "Loss: 0.5807164139354352\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00129: early stopping\n",
      "97/97 [==============================] - 0s 174us/step\n",
      "Loss: 0.7645499890612573\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00111: early stopping\n",
      "97/97 [==============================] - 0s 175us/step\n",
      "Loss: 0.5404430114731347\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 162us/step\n",
      "Loss: 0.49704948036941055\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00134: early stopping\n",
      "97/97 [==============================] - 0s 195us/step\n",
      "Loss: 0.8290092840637129\n",
      "Mean loss: 0.6423536357805901\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 13/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 169us/step\n",
      "Loss: 0.5936577572036035\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00051: early stopping\n",
      "97/97 [==============================] - 0s 181us/step\n",
      "Loss: 0.7345607342179289\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 190us/step\n",
      "Loss: 0.5458237372108341\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 164us/step\n",
      "Loss: 0.49737350166458444\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00074: early stopping\n",
      "97/97 [==============================] - 0s 169us/step\n",
      "Loss: 0.6704271810570943\n",
      "Mean loss: 0.6083685822708091\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 14/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00067: early stopping\n",
      "97/97 [==============================] - 0s 89us/step\n",
      "Loss: 0.6717166660987225\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00100: early stopping\n",
      "97/97 [==============================] - 0s 221us/step\n",
      "Loss: 0.8134843602622908\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00101: early stopping\n",
      "97/97 [==============================] - 0s 95us/step\n",
      "Loss: 0.5331315634791384\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00082: early stopping\n",
      "97/97 [==============================] - 0s 178us/step\n",
      "Loss: 0.5151580025240318\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00118: early stopping\n",
      "97/97 [==============================] - 0s 97us/step\n",
      "Loss: 0.8550603801442176\n",
      "Mean loss: 0.6777101945016802\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 15/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 103us/step\n",
      "Loss: 0.5886969222235925\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 107us/step\n",
      "Loss: 0.7090771702147022\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00060: early stopping\n",
      "97/97 [==============================] - 0s 183us/step\n",
      "Loss: 0.5505245269573841\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00051: early stopping\n",
      "97/97 [==============================] - 0s 139us/step\n",
      "Loss: 0.5046293624897593\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00050: early stopping\n",
      "97/97 [==============================] - 0s 110us/step\n",
      "Loss: 0.6863506374899874\n",
      "Mean loss: 0.6078557238750851\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 16/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00089: early stopping\n",
      "97/97 [==============================] - 0s 257us/step\n",
      "Loss: 0.5924794157755744\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00108: early stopping\n",
      "97/97 [==============================] - 0s 244us/step\n",
      "Loss: 0.7876087470152944\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00127: early stopping\n",
      "97/97 [==============================] - 0s 310us/step\n",
      "Loss: 0.556469687174276\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00066: early stopping\n",
      "97/97 [==============================] - 0s 266us/step\n",
      "Loss: 0.4933066706067508\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00099: early stopping\n",
      "97/97 [==============================] - 0s 254us/step\n",
      "Loss: 0.814497670561997\n",
      "Mean loss: 0.6488724382267785\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 17/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 95us/step\n",
      "Loss: 0.5822775259460371\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00081: early stopping\n",
      "97/97 [==============================] - 0s 85us/step\n",
      "Loss: 0.7207241875609172\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00083: early stopping\n",
      "97/97 [==============================] - 0s 88us/step\n",
      "Loss: 0.5429654066095647\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 93us/step\n",
      "Loss: 0.4946127619939981\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00054: early stopping\n",
      "97/97 [==============================] - 0s 89us/step\n",
      "Loss: 0.6774657297994673\n",
      "Mean loss: 0.6036091223819968\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 18/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00132: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 243us/step\n",
      "Loss: 0.5725130727610637\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00068: early stopping\n",
      "97/97 [==============================] - 0s 286us/step\n",
      "Loss: 0.8140584562242645\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00062: early stopping\n",
      "97/97 [==============================] - 0s 234us/step\n",
      "Loss: 0.5440732013318956\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00092: early stopping\n",
      "97/97 [==============================] - 0s 212us/step\n",
      "Loss: 0.4995226995232179\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00118: early stopping\n",
      "97/97 [==============================] - 0s 208us/step\n",
      "Loss: 0.821154256456906\n",
      "Mean loss: 0.6502643372594695\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 19/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00058: early stopping\n",
      "97/97 [==============================] - 0s 99us/step\n",
      "Loss: 0.5999376011877945\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 95us/step\n",
      "Loss: 0.7636859152734894\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00075: early stopping\n",
      "97/97 [==============================] - 0s 89us/step\n",
      "Loss: 0.5499418135156336\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00069: early stopping\n",
      "97/97 [==============================] - 0s 104us/step\n",
      "Loss: 0.49555183685931964\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00219: early stopping\n",
      "97/97 [==============================] - 0s 99us/step\n",
      "Loss: 0.6966151373902547\n",
      "Mean loss: 0.6211464608452983\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 20/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 131us/step\n",
      "Loss: 0.6100911362883971\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00103: early stopping\n",
      "97/97 [==============================] - 0s 112us/step\n",
      "Loss: 0.7478838446214027\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 124us/step\n",
      "Loss: 0.5487093836376348\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 120us/step\n",
      "Loss: 0.4938477001239344\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00105: early stopping\n",
      "97/97 [==============================] - 0s 194us/step\n",
      "Loss: 0.7085413536460129\n",
      "Mean loss: 0.6218146836634764\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 21/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 267us/step\n",
      "Loss: 0.6056418566359687\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 271us/step\n",
      "Loss: 0.7520466901592373\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 342us/step\n",
      "Loss: 0.5538966972188851\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00051: early stopping\n",
      "97/97 [==============================] - 0s 384us/step\n",
      "Loss: 0.50676430685004\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00099: early stopping\n",
      "97/97 [==============================] - 0s 477us/step\n",
      "Loss: 0.6873551846779499\n",
      "Mean loss: 0.6211409471084163\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 22/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00086: early stopping\n",
      "97/97 [==============================] - 0s 197us/step\n",
      "Loss: 0.6043200081156701\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00071: early stopping\n",
      "97/97 [==============================] - 0s 131us/step\n",
      "Loss: 0.8236175271653637\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00068: early stopping\n",
      "97/97 [==============================] - 0s 210us/step\n",
      "Loss: 0.5614804637800787\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00054: early stopping\n",
      "97/97 [==============================] - 0s 136us/step\n",
      "Loss: 0.5021053921316088\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00520: early stopping\n",
      "97/97 [==============================] - 0s 129us/step\n",
      "Loss: 0.7034275528696394\n",
      "Mean loss: 0.6389901888124722\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 23/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00054: early stopping\n",
      "97/97 [==============================] - 0s 231us/step\n",
      "Loss: 0.5924564114550954\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 240us/step\n",
      "Loss: 0.7635484565164625\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 224us/step\n",
      "Loss: 0.5562869150614002\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00051: early stopping\n",
      "97/97 [==============================] - 0s 300us/step\n",
      "Loss: 0.4969098819899805\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00111: early stopping\n",
      "97/97 [==============================] - 0s 229us/step\n",
      "Loss: 0.6922078366132126\n",
      "Mean loss: 0.6202819003272303\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 24/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00238: early stopping\n",
      "97/97 [==============================] - 0s 246us/step\n",
      "Loss: 0.5932843255013535\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00209: early stopping\n",
      "97/97 [==============================] - 0s 184us/step\n",
      "Loss: 0.7376477509429774\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00055: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 357us/step\n",
      "Loss: 0.5578306437153178\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00089: early stopping\n",
      "97/97 [==============================] - 0s 192us/step\n",
      "Loss: 0.49796522462490905\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00185: early stopping\n",
      "97/97 [==============================] - 0s 192us/step\n",
      "Loss: 0.7121153264930568\n",
      "Mean loss: 0.619768654255523\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 25/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00203: early stopping\n",
      "97/97 [==============================] - 0s 125us/step\n",
      "Loss: 0.6557291604808926\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 178us/step\n",
      "Loss: 1.1063904233814514\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00081: early stopping\n",
      "97/97 [==============================] - 0s 215us/step\n",
      "Loss: 0.5702808603797991\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00059: early stopping\n",
      "97/97 [==============================] - 0s 147us/step\n",
      "Loss: 0.5262169979282261\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00068: early stopping\n",
      "97/97 [==============================] - 0s 134us/step\n",
      "Loss: 0.8886670273603853\n",
      "Mean loss: 0.749456893906151\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 26/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00205: early stopping\n",
      "97/97 [==============================] - 0s 262us/step\n",
      "Loss: 0.6468885442645279\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 250us/step\n",
      "Loss: 0.798652094664033\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00054: early stopping\n",
      "97/97 [==============================] - 0s 270us/step\n",
      "Loss: 0.5649716617520323\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00060: early stopping\n",
      "97/97 [==============================] - 0s 304us/step\n",
      "Loss: 0.49276089483929664\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 263us/step\n",
      "Loss: 0.8864230046567229\n",
      "Mean loss: 0.6779392400353225\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 27/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 215us/step\n",
      "Loss: 0.5607224653676613\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00102: early stopping\n",
      "97/97 [==============================] - 0s 298us/step\n",
      "Loss: 0.6945107278135634\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00055: early stopping\n",
      "97/97 [==============================] - 0s 271us/step\n",
      "Loss: 0.5513546918470835\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 317us/step\n",
      "Loss: 0.49957835797182065\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 241us/step\n",
      "Loss: 0.7138227316522107\n",
      "Mean loss: 0.603997794930468\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 28/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 274us/step\n",
      "Loss: 0.5942006510557588\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 338us/step\n",
      "Loss: 0.7081148120545849\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 246us/step\n",
      "Loss: 0.5538357047690559\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 234us/step\n",
      "Loss: 0.49465610378796293\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00051: early stopping\n",
      "97/97 [==============================] - 0s 333us/step\n",
      "Loss: 0.6772730116991653\n",
      "Mean loss: 0.6056160566733055\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 29/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00070: early stopping\n",
      "97/97 [==============================] - 0s 205us/step\n",
      "Loss: 0.6000572092754325\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00097: early stopping\n",
      "97/97 [==============================] - 0s 224us/step\n",
      "Loss: 0.7490771849130847\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00060: early stopping\n",
      "97/97 [==============================] - 0s 174us/step\n",
      "Loss: 0.553182325719558\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00054: early stopping\n",
      "97/97 [==============================] - 0s 207us/step\n",
      "Loss: 0.49026307064233365\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00104: early stopping\n",
      "97/97 [==============================] - 0s 186us/step\n",
      "Loss: 0.6839093246410802\n",
      "Mean loss: 0.6152978230382977\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 30/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 197us/step\n",
      "Loss: 0.5705882040495726\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00084: early stopping\n",
      "97/97 [==============================] - 0s 190us/step\n",
      "Loss: 0.743363467688413\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 194us/step\n",
      "Loss: 0.5465228619034758\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00054: early stopping\n",
      "97/97 [==============================] - 0s 200us/step\n",
      "Loss: 0.49675043219143583\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00140: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 196us/step\n",
      "Loss: 0.7079285503048258\n",
      "Mean loss: 0.6130307032275446\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 31/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00076: early stopping\n",
      "97/97 [==============================] - 0s 160us/step\n",
      "Loss: 0.5891964650645698\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00089: early stopping\n",
      "97/97 [==============================] - 0s 158us/step\n",
      "Loss: 0.7322585760932607\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 205us/step\n",
      "Loss: 0.5430942826049844\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 165us/step\n",
      "Loss: 0.49609241288961825\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00075: early stopping\n",
      "97/97 [==============================] - 0s 157us/step\n",
      "Loss: 0.6738318828577848\n",
      "Mean loss: 0.6068947239020437\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 32/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00106: early stopping\n",
      "97/97 [==============================] - 0s 190us/step\n",
      "Loss: 0.5940004169326467\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00067: early stopping\n",
      "97/97 [==============================] - 0s 205us/step\n",
      "Loss: 0.8042498691794798\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00096: early stopping\n",
      "97/97 [==============================] - 0s 307us/step\n",
      "Loss: 0.5491026670662398\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00081: early stopping\n",
      "97/97 [==============================] - 0s 178us/step\n",
      "Loss: 0.5015687205127835\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00337: early stopping\n",
      "97/97 [==============================] - 0s 195us/step\n",
      "Loss: 0.6931977093834238\n",
      "Mean loss: 0.6284238766149146\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 33/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 119us/step\n",
      "Loss: 0.6296356793531438\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 190us/step\n",
      "Loss: 0.7496499953810701\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 118us/step\n",
      "Loss: 0.5675219638445943\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 137us/step\n",
      "Loss: 0.5098338901382131\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 130us/step\n",
      "Loss: 0.7117926174217892\n",
      "Mean loss: 0.6336868292277622\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 34/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00056: early stopping\n",
      "97/97 [==============================] - 0s 77us/step\n",
      "Loss: 0.6068318271145379\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00115: early stopping\n",
      "97/97 [==============================] - 0s 93us/step\n",
      "Loss: 0.7735648785055298\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 80us/step\n",
      "Loss: 0.5497487122865067\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 86us/step\n",
      "Loss: 0.5044783888403902\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00071: early stopping\n",
      "97/97 [==============================] - 0s 108us/step\n",
      "Loss: 0.6812975855217767\n",
      "Mean loss: 0.6231842784537482\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 35/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00063: early stopping\n",
      "97/97 [==============================] - 0s 191us/step\n",
      "Loss: 0.5970564920877673\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00121: early stopping\n",
      "97/97 [==============================] - 0s 133us/step\n",
      "Loss: 0.7569379185892872\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00063: early stopping\n",
      "97/97 [==============================] - 0s 215us/step\n",
      "Loss: 0.55448143168823\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00077: early stopping\n",
      "97/97 [==============================] - 0s 146us/step\n",
      "Loss: 0.49481259424661855\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00177: early stopping\n",
      "97/97 [==============================] - 0s 139us/step\n",
      "Loss: 0.7199032868921142\n",
      "Mean loss: 0.6246383447008034\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 36/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00082: early stopping\n",
      "97/97 [==============================] - 0s 107us/step\n",
      "Loss: 0.5940249377919227\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00043: early stopping\n",
      "97/97 [==============================] - 0s 105us/step\n",
      "Loss: 0.7787535092265335\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 112us/step\n",
      "Loss: 0.5463809911737737\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00092: early stopping\n",
      "97/97 [==============================] - 0s 95us/step\n",
      "Loss: 0.5040673687285984\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00159: early stopping\n",
      "97/97 [==============================] - 0s 94us/step\n",
      "Loss: 0.7635295394155168\n",
      "Mean loss: 0.637351269267269\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 37/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00044: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 137us/step\n",
      "Loss: 0.5875322714294355\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00084: early stopping\n",
      "97/97 [==============================] - 0s 140us/step\n",
      "Loss: 0.7319064478284305\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 163us/step\n",
      "Loss: 0.5497325314688928\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00044: early stopping\n",
      "97/97 [==============================] - 0s 152us/step\n",
      "Loss: 0.49290644016462504\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00067: early stopping\n",
      "97/97 [==============================] - 0s 151us/step\n",
      "Loss: 0.6895254318861618\n",
      "Mean loss: 0.6103206245555091\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 38/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00082: early stopping\n",
      "97/97 [==============================] - 0s 233us/step\n",
      "Loss: 0.5953706072777817\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00096: early stopping\n",
      "97/97 [==============================] - 0s 234us/step\n",
      "Loss: 0.7176401498391456\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 237us/step\n",
      "Loss: 0.5440706979368151\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 227us/step\n",
      "Loss: 0.4932528672759066\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00087: early stopping\n",
      "97/97 [==============================] - 0s 248us/step\n",
      "Loss: 0.6834160452036514\n",
      "Mean loss: 0.60675007350666\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 39/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00061: early stopping\n",
      "97/97 [==============================] - 0s 93us/step\n",
      "Loss: 0.6144141941955409\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00062: early stopping\n",
      "97/97 [==============================] - 0s 95us/step\n",
      "Loss: 0.7514696735696694\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 92us/step\n",
      "Loss: 0.5580751195396345\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 92us/step\n",
      "Loss: 0.5019844186674688\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00076: early stopping\n",
      "97/97 [==============================] - 0s 146us/step\n",
      "Loss: 0.6727554942529226\n",
      "Mean loss: 0.6197397800450473\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 40/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00063: early stopping\n",
      "97/97 [==============================] - 0s 174us/step\n",
      "Loss: 0.5839207436620575\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00043: early stopping\n",
      "97/97 [==============================] - 0s 141us/step\n",
      "Loss: 0.7254873102473229\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00073: early stopping\n",
      "97/97 [==============================] - 0s 169us/step\n",
      "Loss: 0.52710814482158\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 251us/step\n",
      "Loss: 0.49298097976704236\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 157us/step\n",
      "Loss: 0.6713992025434357\n",
      "Mean loss: 0.6001792762082877\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 41/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00086: early stopping\n",
      "97/97 [==============================] - 0s 130us/step\n",
      "Loss: 0.5917850972450885\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00078: early stopping\n",
      "97/97 [==============================] - 0s 160us/step\n",
      "Loss: 0.7059229907301283\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 146us/step\n",
      "Loss: 0.545022148139698\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00044: early stopping\n",
      "97/97 [==============================] - 0s 143us/step\n",
      "Loss: 0.5041534464383862\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 136us/step\n",
      "Loss: 0.6848771409275606\n",
      "Mean loss: 0.6063521646961723\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 42/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00071: early stopping\n",
      "97/97 [==============================] - 0s 155us/step\n",
      "Loss: 0.5820277622065593\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00067: early stopping\n",
      "97/97 [==============================] - 0s 115us/step\n",
      "Loss: 0.739740779104921\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00067: early stopping\n",
      "97/97 [==============================] - 0s 130us/step\n",
      "Loss: 0.5509058888425532\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 131us/step\n",
      "Loss: 0.49397774701265945\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00148: early stopping\n",
      "97/97 [==============================] - 0s 112us/step\n",
      "Loss: 0.6909975855006385\n",
      "Mean loss: 0.6115299525334662\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 43/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00133: early stopping\n",
      "97/97 [==============================] - 0s 302us/step\n",
      "Loss: 0.5881253659110708\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00059: early stopping\n",
      "97/97 [==============================] - 0s 268us/step\n",
      "Loss: 0.8204583187693173\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00075: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 249us/step\n",
      "Loss: 0.548689008988056\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00150: early stopping\n",
      "97/97 [==============================] - 0s 336us/step\n",
      "Loss: 0.49853202239754274\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00235: early stopping\n",
      "97/97 [==============================] - 0s 275us/step\n",
      "Loss: 0.8200575101006892\n",
      "Mean loss: 0.6551724452333352\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 44/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00084: early stopping\n",
      "97/97 [==============================] - 0s 314us/step\n",
      "Loss: 0.5789720440648266\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00147: early stopping\n",
      "97/97 [==============================] - 0s 288us/step\n",
      "Loss: 0.710237263404217\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 310us/step\n",
      "Loss: 0.5488470460950714\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00068: early stopping\n",
      "97/97 [==============================] - 0s 287us/step\n",
      "Loss: 0.49403062739323095\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00241: early stopping\n",
      "97/97 [==============================] - 0s 294us/step\n",
      "Loss: 0.7019164193536818\n",
      "Mean loss: 0.6068006800622056\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 45/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00132: early stopping\n",
      "97/97 [==============================] - 0s 92us/step\n",
      "Loss: 0.5821952297515476\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00126: early stopping\n",
      "97/97 [==============================] - 0s 108us/step\n",
      "Loss: 0.7662257699622321\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00084: early stopping\n",
      "97/97 [==============================] - 0s 100us/step\n",
      "Loss: 0.5396042997689591\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00069: early stopping\n",
      "97/97 [==============================] - 0s 102us/step\n",
      "Loss: 0.49749563342517183\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00241: early stopping\n",
      "97/97 [==============================] - 0s 90us/step\n",
      "Loss: 0.7526890930441237\n",
      "Mean loss: 0.6276420051904068\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 46/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 131us/step\n",
      "Loss: 0.5930964614927154\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 155us/step\n",
      "Loss: 0.7425723837822983\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 121us/step\n",
      "Loss: 0.5476003611825176\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 113us/step\n",
      "Loss: 0.49586784470941603\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00070: early stopping\n",
      "97/97 [==============================] - 0s 108us/step\n",
      "Loss: 0.6902384668895879\n",
      "Mean loss: 0.613875103611307\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 47/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00190: early stopping\n",
      "97/97 [==============================] - 0s 96us/step\n",
      "Loss: 0.6058032266872445\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00172: early stopping\n",
      "97/97 [==============================] - 0s 89us/step\n",
      "Loss: 0.8388914435180193\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00090: early stopping\n",
      "97/97 [==============================] - 0s 88us/step\n",
      "Loss: 0.5554589871893224\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00101: early stopping\n",
      "97/97 [==============================] - 0s 94us/step\n",
      "Loss: 0.50862916597386\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00128: early stopping\n",
      "97/97 [==============================] - 0s 93us/step\n",
      "Loss: 0.838505720354847\n",
      "Mean loss: 0.6694577087446587\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 48/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 283us/step\n",
      "Loss: 0.6198861414624244\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00050: early stopping\n",
      "97/97 [==============================] - 0s 285us/step\n",
      "Loss: 0.758019949972015\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 290us/step\n",
      "Loss: 0.5262427385320368\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 275us/step\n",
      "Loss: 0.4983836025306859\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 281us/step\n",
      "Loss: 0.7216178077397887\n",
      "Mean loss: 0.6248300480473901\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 49/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00127: early stopping\n",
      "97/97 [==============================] - 0s 248us/step\n",
      "Loss: 0.5856465199559006\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 294us/step\n",
      "Loss: 0.7865017996620887\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00070: early stopping\n",
      "97/97 [==============================] - 0s 236us/step\n",
      "Loss: 0.5530495228841132\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00094: early stopping\n",
      "97/97 [==============================] - 0s 256us/step\n",
      "Loss: 0.4991320592840922\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00085: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 224us/step\n",
      "Loss: 0.8273895714700836\n",
      "Mean loss: 0.6503438946512556\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 50/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 159us/step\n",
      "Loss: 0.608692559999289\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00103: early stopping\n",
      "97/97 [==============================] - 0s 175us/step\n",
      "Loss: 0.7589441451829734\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00083: early stopping\n",
      "97/97 [==============================] - 0s 395us/step\n",
      "Loss: 0.5589938818179455\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00067: early stopping\n",
      "97/97 [==============================] - 0s 180us/step\n",
      "Loss: 0.4976524298953027\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00105: early stopping\n",
      "97/97 [==============================] - 0s 182us/step\n",
      "Loss: 0.6911060081929276\n",
      "Mean loss: 0.6230778050176877\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 51/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 155us/step\n",
      "Loss: 0.5960973040344789\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00182: early stopping\n",
      "97/97 [==============================] - 0s 145us/step\n",
      "Loss: 0.7422546160589788\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00059: early stopping\n",
      "97/97 [==============================] - 0s 167us/step\n",
      "Loss: 0.5561737691618732\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 177us/step\n",
      "Loss: 0.4973839023678573\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00234: early stopping\n",
      "97/97 [==============================] - 0s 178us/step\n",
      "Loss: 0.7060904075804445\n",
      "Mean loss: 0.6195999998407266\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 52/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00090: early stopping\n",
      "97/97 [==============================] - 0s 374us/step\n",
      "Loss: 0.5847447330189735\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00105: early stopping\n",
      "97/97 [==============================] - 0s 271us/step\n",
      "Loss: 0.7413804899785936\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00050: early stopping\n",
      "97/97 [==============================] - 0s 276us/step\n",
      "Loss: 0.5414633950621811\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00064: early stopping\n",
      "97/97 [==============================] - 0s 271us/step\n",
      "Loss: 0.49918813066384227\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00110: early stopping\n",
      "97/97 [==============================] - 0s 299us/step\n",
      "Loss: 0.677074699672227\n",
      "Mean loss: 0.6087702896791635\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 53/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00086: early stopping\n",
      "97/97 [==============================] - 0s 317us/step\n",
      "Loss: 0.5778909233427539\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 260us/step\n",
      "Loss: 0.7773271971142169\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00078: early stopping\n",
      "97/97 [==============================] - 0s 278us/step\n",
      "Loss: 0.5356052305895028\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00043: early stopping\n",
      "97/97 [==============================] - 0s 263us/step\n",
      "Loss: 0.5063461618325145\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00075: early stopping\n",
      "97/97 [==============================] - 0s 298us/step\n",
      "Loss: 0.8405938805993071\n",
      "Mean loss: 0.647552678695659\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 54/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 147us/step\n",
      "Loss: 0.6184471311028471\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00121: early stopping\n",
      "97/97 [==============================] - 0s 219us/step\n",
      "Loss: 0.7764065388551692\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00067: early stopping\n",
      "97/97 [==============================] - 0s 140us/step\n",
      "Loss: 0.5622247583472851\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 142us/step\n",
      "Loss: 0.5030448657950175\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00252: early stopping\n",
      "97/97 [==============================] - 0s 207us/step\n",
      "Loss: 0.706169266368925\n",
      "Mean loss: 0.6332585120938488\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 55/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00097: early stopping\n",
      "97/97 [==============================] - 0s 255us/step\n",
      "Loss: 0.7265369652472821\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00378: early stopping\n",
      "97/97 [==============================] - 0s 294us/step\n",
      "Loss: 1.1189842691126557\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00219: early stopping\n",
      "97/97 [==============================] - 0s 331us/step\n",
      "Loss: 0.5730404810807139\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00189: early stopping\n",
      "97/97 [==============================] - 0s 281us/step\n",
      "Loss: 0.5276464912080273\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00079: early stopping\n",
      "97/97 [==============================] - 0s 276us/step\n",
      "Loss: 0.9729743704353411\n",
      "Mean loss: 0.7838365154168041\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 56/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 161us/step\n",
      "Loss: 0.5901366638154099\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 155us/step\n",
      "Loss: 0.748859883583698\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00051: early stopping\n",
      "97/97 [==============================] - 0s 126us/step\n",
      "Loss: 0.5369045931039397\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 125us/step\n",
      "Loss: 0.48236439830249117\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00150: early stopping\n",
      "97/97 [==============================] - 0s 130us/step\n",
      "Loss: 0.7203726983561958\n",
      "Mean loss: 0.6157276474323469\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 57/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 232us/step\n",
      "Loss: 0.5919818263692954\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00121: early stopping\n",
      "97/97 [==============================] - 0s 116us/step\n",
      "Loss: 0.7325438371638662\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 120us/step\n",
      "Loss: 0.5553790883919627\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 119us/step\n",
      "Loss: 0.4989747355893715\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00117: early stopping\n",
      "97/97 [==============================] - 0s 119us/step\n",
      "Loss: 0.7222890091925552\n",
      "Mean loss: 0.6202336993414101\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 58/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00074: early stopping\n",
      "97/97 [==============================] - 0s 272us/step\n",
      "Loss: 0.5965557878779382\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00095: early stopping\n",
      "97/97 [==============================] - 0s 254us/step\n",
      "Loss: 0.7182407999776074\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00072: early stopping\n",
      "97/97 [==============================] - 0s 280us/step\n",
      "Loss: 0.5535035111854986\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 269us/step\n",
      "Loss: 0.49569724699885576\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00143: early stopping\n",
      "97/97 [==============================] - 0s 274us/step\n",
      "Loss: 0.6899256512676317\n",
      "Mean loss: 0.6107845994615063\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 59/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00096: early stopping\n",
      "97/97 [==============================] - 0s 282us/step\n",
      "Loss: 0.7277834820993168\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00337: early stopping\n",
      "97/97 [==============================] - 0s 282us/step\n",
      "Loss: 0.8635594082861832\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00503: early stopping\n",
      "97/97 [==============================] - 0s 308us/step\n",
      "Loss: 0.5694228444517273\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00092: early stopping\n",
      "97/97 [==============================] - 0s 295us/step\n",
      "Loss: 0.5252913648320228\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00276: early stopping\n",
      "97/97 [==============================] - 0s 275us/step\n",
      "Loss: 0.8386993147048754\n",
      "Mean loss: 0.704951282874825\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 60/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 125us/step\n",
      "Loss: 0.5964011242709208\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00080: early stopping\n",
      "97/97 [==============================] - 0s 128us/step\n",
      "Loss: 0.7145459903884179\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00076: early stopping\n",
      "97/97 [==============================] - 0s 130us/step\n",
      "Loss: 0.5443257440611259\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 124us/step\n",
      "Loss: 0.5029294429366121\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00101: early stopping\n",
      "97/97 [==============================] - 0s 124us/step\n",
      "Loss: 0.6816831642819434\n",
      "Mean loss: 0.6079770931878041\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 61/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00087: early stopping\n",
      "97/97 [==============================] - 0s 145us/step\n",
      "Loss: 0.5867400568785127\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00075: early stopping\n",
      "97/97 [==============================] - 0s 140us/step\n",
      "Loss: 0.7356016721922097\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00062: early stopping\n",
      "97/97 [==============================] - 0s 134us/step\n",
      "Loss: 0.5525470016543398\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 136us/step\n",
      "Loss: 0.4945925978041187\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00140: early stopping\n",
      "97/97 [==============================] - 0s 141us/step\n",
      "Loss: 0.7124262820814073\n",
      "Mean loss: 0.6163815221221176\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 62/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00050: early stopping\n",
      "97/97 [==============================] - 0s 208us/step\n",
      "Loss: 0.5961553927549382\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00111: early stopping\n",
      "97/97 [==============================] - 0s 89us/step\n",
      "Loss: 0.7478066774987683\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 103us/step\n",
      "Loss: 0.5482784300735316\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 111us/step\n",
      "Loss: 0.49546575853505087\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00116: early stopping\n",
      "97/97 [==============================] - 0s 104us/step\n",
      "Loss: 0.6770502331945085\n",
      "Mean loss: 0.6129512984113595\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 63/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00104: early stopping\n",
      "97/97 [==============================] - 0s 175us/step\n",
      "Loss: 0.5869781036966855\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 196us/step\n",
      "Loss: 0.7266165183991501\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 258us/step\n",
      "Loss: 0.5495972525827664\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00051: early stopping\n",
      "97/97 [==============================] - 0s 186us/step\n",
      "Loss: 0.4952440814873607\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 216us/step\n",
      "Loss: 0.7005290496595127\n",
      "Mean loss: 0.6117930011650949\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 64/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00178: early stopping\n",
      "97/97 [==============================] - 0s 219us/step\n",
      "Loss: 0.5906489092050139\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00065: early stopping\n",
      "97/97 [==============================] - 0s 242us/step\n",
      "Loss: 1.119279062625059\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00141: early stopping\n",
      "97/97 [==============================] - 0s 238us/step\n",
      "Loss: 0.5814655469250434\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00073: early stopping\n",
      "97/97 [==============================] - 0s 237us/step\n",
      "Loss: 0.5126202659508616\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 240us/step\n",
      "Loss: 0.8473105147941825\n",
      "Mean loss: 0.7302648599000321\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 65/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00114: early stopping\n",
      "97/97 [==============================] - 0s 297us/step\n",
      "Loss: 0.5803450524192495\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00119: early stopping\n",
      "97/97 [==============================] - 0s 336us/step\n",
      "Loss: 0.7419576884545002\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00059: early stopping\n",
      "97/97 [==============================] - 0s 281us/step\n",
      "Loss: 0.5416696830508635\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 288us/step\n",
      "Loss: 0.5011700840340447\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00080: early stopping\n",
      "97/97 [==============================] - 0s 267us/step\n",
      "Loss: 0.7462078283742531\n",
      "Mean loss: 0.6222700672665822\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 66/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00185: early stopping\n",
      "97/97 [==============================] - 0s 221us/step\n",
      "Loss: 0.5895351153059104\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00172: early stopping\n",
      "97/97 [==============================] - 0s 208us/step\n",
      "Loss: 0.7355148706239524\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00064: early stopping\n",
      "97/97 [==============================] - 0s 208us/step\n",
      "Loss: 0.5530033268264889\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00064: early stopping\n",
      "97/97 [==============================] - 0s 199us/step\n",
      "Loss: 0.4994433288721694\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00191: early stopping\n",
      "97/97 [==============================] - 0s 206us/step\n",
      "Loss: 0.7120850224470355\n",
      "Mean loss: 0.6179163328151114\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 67/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00164: early stopping\n",
      "97/97 [==============================] - 0s 236us/step\n",
      "Loss: 0.577682946146149\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00106: early stopping\n",
      "97/97 [==============================] - 0s 245us/step\n",
      "Loss: 0.7300031609141949\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00068: early stopping\n",
      "97/97 [==============================] - 0s 275us/step\n",
      "Loss: 0.5382803721526235\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00090: early stopping\n",
      "97/97 [==============================] - 0s 307us/step\n",
      "Loss: 0.5049552100220907\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00114: early stopping\n",
      "97/97 [==============================] - 0s 242us/step\n",
      "Loss: 0.7281012104958603\n",
      "Mean loss: 0.6158045799461837\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 68/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00141: early stopping\n",
      "97/97 [==============================] - 0s 201us/step\n",
      "Loss: 0.5909974575042725\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00059: early stopping\n",
      "97/97 [==============================] - 0s 214us/step\n",
      "Loss: 0.8148520828522358\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00148: early stopping\n",
      "97/97 [==============================] - 0s 207us/step\n",
      "Loss: 0.539841590775657\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00128: early stopping\n",
      "97/97 [==============================] - 0s 223us/step\n",
      "Loss: 0.49459148805166026\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00161: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 284us/step\n",
      "Loss: 0.8255491705284905\n",
      "Mean loss: 0.6531663579424631\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 69/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00055: early stopping\n",
      "97/97 [==============================] - 0s 112us/step\n",
      "Loss: 0.6254548737683248\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 82us/step\n",
      "Loss: 0.7341433179747198\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00044: early stopping\n",
      "97/97 [==============================] - 0s 84us/step\n",
      "Loss: 0.5566485619422087\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 88us/step\n",
      "Loss: 0.5176946066089512\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00050: early stopping\n",
      "97/97 [==============================] - 0s 78us/step\n",
      "Loss: 0.6893453275420002\n",
      "Mean loss: 0.624657337567241\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 70/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 200us/step\n",
      "Loss: 0.5962209369718414\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00063: early stopping\n",
      "97/97 [==============================] - 0s 212us/step\n",
      "Loss: 0.7440869500956584\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 212us/step\n",
      "Loss: 0.547088206121602\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00044: early stopping\n",
      "97/97 [==============================] - 0s 233us/step\n",
      "Loss: 0.4916588719358149\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00076: early stopping\n",
      "97/97 [==============================] - 0s 263us/step\n",
      "Loss: 0.689240754879627\n",
      "Mean loss: 0.6136591440009088\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 71/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00062: early stopping\n",
      "97/97 [==============================] - 0s 231us/step\n",
      "Loss: 0.5833874670500608\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00120: early stopping\n",
      "97/97 [==============================] - 0s 225us/step\n",
      "Loss: 0.7078346235235942\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00054: early stopping\n",
      "97/97 [==============================] - 0s 241us/step\n",
      "Loss: 0.5351739396754\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 236us/step\n",
      "Loss: 0.48322979015173373\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00082: early stopping\n",
      "97/97 [==============================] - 0s 233us/step\n",
      "Loss: 0.6839676874200094\n",
      "Mean loss: 0.5987187015641596\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 72/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00150: early stopping\n",
      "97/97 [==============================] - 0s 83us/step\n",
      "Loss: 0.5942591262846878\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00161: early stopping\n",
      "97/97 [==============================] - 0s 79us/step\n",
      "Loss: 0.7919852745901678\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00077: early stopping\n",
      "97/97 [==============================] - 0s 83us/step\n",
      "Loss: 0.5505882169782501\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 90us/step\n",
      "Loss: 0.5147699848892763\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00061: early stopping\n",
      "97/97 [==============================] - 0s 88us/step\n",
      "Loss: 0.857886367237445\n",
      "Mean loss: 0.6618977939959654\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 73/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 150us/step\n",
      "Loss: 0.6067280314632297\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 176us/step\n",
      "Loss: 0.7437838365122215\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 165us/step\n",
      "Loss: 0.5529254748649204\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 158us/step\n",
      "Loss: 0.49576130601548657\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00066: early stopping\n",
      "97/97 [==============================] - 0s 189us/step\n",
      "Loss: 0.6835012958221829\n",
      "Mean loss: 0.6165399889356082\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 74/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00154: early stopping\n",
      "97/97 [==============================] - 0s 234us/step\n",
      "Loss: 0.5819818451232517\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00142: early stopping\n",
      "97/97 [==============================] - 0s 182us/step\n",
      "Loss: 0.8183173365199689\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00072: early stopping\n",
      "97/97 [==============================] - 0s 175us/step\n",
      "Loss: 0.5689627242457006\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00119: early stopping\n",
      "97/97 [==============================] - 0s 197us/step\n",
      "Loss: 0.5029289028079239\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00167: early stopping\n",
      "97/97 [==============================] - 0s 207us/step\n",
      "Loss: 0.8204519146496487\n",
      "Mean loss: 0.6585285446692988\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 75/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00060: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 131us/step\n",
      "Loss: 0.583038788480857\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00058: early stopping\n",
      "97/97 [==============================] - 0s 126us/step\n",
      "Loss: 0.7518381328926873\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00059: early stopping\n",
      "97/97 [==============================] - 0s 123us/step\n",
      "Loss: 0.5580489939635562\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00044: early stopping\n",
      "97/97 [==============================] - 0s 153us/step\n",
      "Loss: 0.49280328726031114\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00218: early stopping\n",
      "97/97 [==============================] - 0s 113us/step\n",
      "Loss: 0.6856648221458357\n",
      "Mean loss: 0.6142788049486494\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 76/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00050: early stopping\n",
      "97/97 [==============================] - 0s 237us/step\n",
      "Loss: 0.6011302059458703\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 233us/step\n",
      "Loss: 0.7434410505073586\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 219us/step\n",
      "Loss: 0.552064833874555\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00043: early stopping\n",
      "97/97 [==============================] - 0s 213us/step\n",
      "Loss: 0.5036529013791036\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00050: early stopping\n",
      "97/97 [==============================] - 0s 285us/step\n",
      "Loss: 0.6874202342377496\n",
      "Mean loss: 0.6175418451889274\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 77/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00052: early stopping\n",
      "97/97 [==============================] - 0s 151us/step\n",
      "Loss: 0.5906239883186891\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00056: early stopping\n",
      "97/97 [==============================] - 0s 153us/step\n",
      "Loss: 0.7242318969411948\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00049: early stopping\n",
      "97/97 [==============================] - 0s 260us/step\n",
      "Loss: 0.5653322821425408\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00048: early stopping\n",
      "97/97 [==============================] - 0s 157us/step\n",
      "Loss: 0.4771663214742523\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 156us/step\n",
      "Loss: 0.6839375797006273\n",
      "Mean loss: 0.6082584137154609\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 78/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00110: early stopping\n",
      "97/97 [==============================] - 0s 337us/step\n",
      "Loss: 0.6870982567059625\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00066: early stopping\n",
      "97/97 [==============================] - 0s 277us/step\n",
      "Loss: 1.1188649209504276\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00118: early stopping\n",
      "97/97 [==============================] - 0s 292us/step\n",
      "Loss: 0.5525955997177006\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00069: early stopping\n",
      "97/97 [==============================] - 0s 317us/step\n",
      "Loss: 0.5318248548458532\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00320: early stopping\n",
      "97/97 [==============================] - 0s 296us/step\n",
      "Loss: 0.9015295032373408\n",
      "Mean loss: 0.7583826270914569\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 79/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00056: early stopping\n",
      "97/97 [==============================] - 0s 276us/step\n",
      "Loss: 0.5938628309780789\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 280us/step\n",
      "Loss: 0.7481067623059774\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00047: early stopping\n",
      "97/97 [==============================] - 0s 271us/step\n",
      "Loss: 0.5457462603898392\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00045: early stopping\n",
      "97/97 [==============================] - 0s 279us/step\n",
      "Loss: 0.5018553008738252\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00080: early stopping\n",
      "97/97 [==============================] - 0s 324us/step\n",
      "Loss: 0.6897757658638906\n",
      "Mean loss: 0.6158693840823223\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 80/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00115: early stopping\n",
      "97/97 [==============================] - 0s 178us/step\n",
      "Loss: 0.589564318509446\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00082: early stopping\n",
      "97/97 [==============================] - 0s 185us/step\n",
      "Loss: 0.7347417479937839\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00062: early stopping\n",
      "97/97 [==============================] - 0s 180us/step\n",
      "Loss: 0.5561142551530268\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00046: early stopping\n",
      "97/97 [==============================] - 0s 180us/step\n",
      "Loss: 0.49388295473511684\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00154: early stopping\n",
      "97/97 [==============================] - 0s 255us/step\n",
      "Loss: 0.6897738557500938\n",
      "Mean loss: 0.6128154264282935\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 81/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00088: early stopping\n",
      "97/97 [==============================] - 0s 126us/step\n",
      "Loss: 0.6093503857396313\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00057: early stopping\n",
      "97/97 [==============================] - 0s 131us/step\n",
      "Loss: 0.8216301571462572\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00083: early stopping\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "97/97 [==============================] - 0s 121us/step\n",
      "Loss: 0.5640802398784873\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00053: early stopping\n",
      "97/97 [==============================] - 0s 170us/step\n",
      "Loss: 0.49628691452065693\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00097: early stopping\n",
      "97/97 [==============================] - 0s 117us/step\n",
      "Loss: 0.8314838212789949\n",
      "Mean loss: 0.6645663037128056\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 82/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00100: early stopping\n",
      "97/97 [==============================] - 0s 177us/step\n",
      "Loss: 0.5789944824484206\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00126: early stopping\n",
      "97/97 [==============================] - 0s 211us/step\n",
      "Loss: 0.7471384584289236\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00068: early stopping\n",
      "97/97 [==============================] - 0s 173us/step\n",
      "Loss: 0.5374974356484168\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00044: early stopping\n",
      "97/97 [==============================] - 0s 200us/step\n",
      "Loss: 0.4933106536717759\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00086: early stopping\n",
      "97/97 [==============================] - 0s 205us/step\n",
      "Loss: 0.679297875497759\n",
      "Mean loss: 0.6072477811390591\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 83/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00097: early stopping\n",
      "97/97 [==============================] - 0s 273us/step\n",
      "Loss: 0.6560606360435486\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00162: early stopping\n",
      "97/97 [==============================] - 0s 385us/step\n",
      "Loss: 0.8250195556080219\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00142: early stopping\n",
      "97/97 [==============================] - 0s 247us/step\n",
      "Loss: 0.5433980914735302\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00074: early stopping\n",
      "97/97 [==============================] - 0s 249us/step\n",
      "Loss: 0.5018986856814512\n",
      "Train member Nr 5/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00175: early stopping\n",
      "97/97 [==============================] - 0s 246us/step\n",
      "Loss: 0.8181399801342758\n",
      "Mean loss: 0.6689033897881657\n",
      "\n",
      "##################################################################\n",
      "Search iteration Nr 84/100\n",
      "##################################################################\n",
      "\n",
      "Train member Nr 1/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00070: early stopping\n",
      "97/97 [==============================] - 0s 278us/step\n",
      "Loss: 0.6717564727842193\n",
      "Train member Nr 2/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00076: early stopping\n",
      "97/97 [==============================] - 0s 274us/step\n",
      "Loss: 0.8197638779571376\n",
      "Train member Nr 3/5\n",
      "--------------------------------------\n",
      "Restoring model weights from the end of the best epoch\n",
      "Epoch 00077: early stopping\n",
      "97/97 [==============================] - 0s 225us/step\n",
      "Loss: 0.5413025632961509\n",
      "Train member Nr 4/5\n",
      "--------------------------------------\n"
     ]
    }
   ],
   "source": [
    "import keras.backend as K\n",
    "from ninolearn.learn.models.encoderDecoder import EncoderDecoder\n",
    "\n",
    "K.clear_session()\n",
    "\n",
    "model = EncoderDecoder()\n",
    "\n",
    "model.set_parameters(neurons=[(32, 8), (512, 64)], dropout=[0., 0.2], noise=[0., 0.5] , noise_out=[0., 0.5],\n",
    "         l1_hidden=[0.0, 0.001], l2_hidden=[0.0, 0.001], l1_out=[0.0, 0.001], l2_out=[0.0, 0.001], batch_size=100,\n",
    "         lr=[0.0001, 0.01], n_segments=5, n_members_segment=1, patience = 40, epochs=1000, verbose=0)\n",
    "\n",
    "model.fit_RandomizedSearch(train_val_X, train_val_y, n_iter=100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Make predictions on the test data set"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import xarray as xr\n",
    "\n",
    "# make prediction\n",
    "pred, pred_all_members = model.predict(testX)\n",
    "test_label = scaler_l.inverse_transform(testy)\n",
    "\n",
    "# reshape data into an xarray data array that is 3-D\n",
    "pred_map = xr.zeros_like(label[lead+shift:,:,:][test_indeces])\n",
    "pred_map.values = scaler_l.inverse_transform(pred).reshape((testX.shape[0], label.shape[1], label.shape[2]))\n",
    "\n",
    "test_label_map = xr.zeros_like(label[lead+shift:,:,:][test_indeces])\n",
    "test_label_map.values = test_label.reshape((testX.shape[0], label.shape[1], label.shape[2]))\n",
    "\n",
    "# calculate the ONI\n",
    "pred_oni = pred_map.loc[dict(lat=slice(-5, 5), lon=slice(190, 240))].mean(dim=\"lat\").mean(dim='lon')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot prediction for the ONI"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "# Plot ONI Forecasts\n",
    "plt.subplots(figsize=(8,1.8))\n",
    "\n",
    "plt.plot(testtimey, pred_oni, c='navy')\n",
    "plt.plot(testtimey, oni.loc[testtimey[0]: testtimey[-1]], \"k\")\n",
    "\n",
    "plt.xlabel('Time [Year]')\n",
    "plt.ylabel('ONI [K]')\n",
    "\n",
    "plt.axhspan(-0.5, -6, facecolor='blue',  alpha=0.1,zorder=0)\n",
    "plt.axhspan(0.5, 6, facecolor='red', alpha=0.1,zorder=0)\n",
    "\n",
    "plt.xlim(testtimey[0], testtimey[-1])\n",
    "plt.ylim(-3,3)\n",
    "\n",
    "plt.title(f\"Lead time: {lead} month\")\n",
    "plt.grid()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Evaluate the seasonal skill for predicting the ONI"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from ninolearn.plot.evaluation import plot_correlation\n",
    "import pandas as pd\n",
    "\n",
    "# make a plot of the seasonal correaltion\n",
    "# note: - pd.tseries.offsets.MonthBegin(1) appears to ensure that the correlations are plotted\n",
    "# agains the correct season\n",
    "\n",
    "plot_correlation(oni.loc[testtimey[0]: testtimey[-1]], pred_oni, testtimey - pd.tseries.offsets.MonthBegin(1), title=\"\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Check the correlations on a map\n",
    "\n",
    "In the following the pearson correlation coefficent between the predicted and the observed value for each grid point are computed and afterwards plotted."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# rehshape predictions to a map\n",
    "corr_map = np.zeros(pred.shape[1])\n",
    "\n",
    "for j in range(len(corr_map)):\n",
    "    corr_map[j] = np.corrcoef(pred[:,j], test_label[:,j])[0,1]\n",
    "corr_map = corr_map.reshape((label.shape[1:]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "# Plot correlation map\n",
    "fig, ax = plt.subplots(figsize=(8,2))\n",
    "plt.title(f\"Lead time: {lead} month\")\n",
    "C=ax.imshow(corr_map, origin='lower', vmin=0, vmax=1)\n",
    "cb=plt.colorbar(C)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Animate the full test prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.animation as animation\n",
    "\n",
    "def animation_ed(true, pred, nino,  nino_pred, time):\n",
    "    fig, ax = plt.subplots(3, 1, figsize=(6,7), squeeze=False)\n",
    "\n",
    "    vmin = -3\n",
    "    vmax = 3\n",
    "\n",
    "    true_im = ax[0,0].imshow(true[0], origin='lower', vmin=vmin, vmax=vmax, cmap=plt.cm.bwr)\n",
    "    pred_im = ax[1,0].imshow(pred[0], origin='lower', vmin=vmin, vmax=vmax, cmap=plt.cm.bwr)\n",
    "    title = ax[0,0].set_title('')\n",
    "\n",
    "    ax[2,0].plot(time, nino)\n",
    "    ax[2,0].plot(time, nino_pred)\n",
    "    ax[2,0].set_ylim(-3,3)\n",
    "    ax[2,0].set_xlim(time[0], time[-1])\n",
    "\n",
    "    vline = ax[2,0].plot([time[0], time[0]], [-10,10], color='k')\n",
    "\n",
    "\n",
    "    def update(data):\n",
    "        true_im.set_data(data[0])\n",
    "        pred_im.set_data(data[1])\n",
    "        title_str = np.datetime_as_string(data[0].time.values)[:10]\n",
    "        title.set_text(title_str)\n",
    "\n",
    "        vline[0].set_data([data[2], data[2]],[-10,10])\n",
    "\n",
    "    def data_gen():\n",
    "        k = 0\n",
    "        kmax = len(true)\n",
    "        while k<kmax:\n",
    "\n",
    "            yield true.loc[time[k]], pred.loc[time[k]], time[k]\n",
    "            k+=1\n",
    "\n",
    "    ani = animation.FuncAnimation(fig, update, data_gen, interval=100, repeat=False, save_count=len(true))\n",
    "    plt.close(\"all\")\n",
    "    return ani"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from IPython.display import HTML\n",
    "ani = animation_ed(test_label_map, pred_map, \n",
    "                   oni.loc[testtimey[0]:testtimey[-1]], pred_oni, \n",
    "                   testtimey)\n",
    "\n",
    "HTML(ani.to_html5_video())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So it looks like that the Encoder-Decoder ensemble has some skill. However, more research is needed to release the full potential of this model. \n",
    "\n",
    "Maybe you are interested working on this? :D"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
